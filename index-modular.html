<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>VAST Asteroids</title>
    
    <!-- Libraries -->
    <script src="jquery-1.4.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="vector_battle_regular.typeface.js"></script>
    <script src="ipad.js"></script>

    <!-- Web Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600&display=swap" rel="stylesheet">

    <!-- UI Styles -->
    <link rel="stylesheet" href="src/styles/ui.css">
    
    <!-- Config -->
    <script src="src/config/constants.js"></script>
    
    <!-- Utilities -->
    <script src="src/utils/matrix.js"></script>
    <script src="src/utils/grid-node.js"></script>
    <script src="src/utils/text-renderer.js"></script>
    <script src="src/utils/glow-renderer.js"></script>

    <!-- UI Helpers -->
    <script src="src/ui/animations.js"></script>
    <script src="src/ui/hud.js"></script>
    <script src="src/ui/scoreboard.js"></script>
    <script src="src/ui/game-over.js"></script>
    <script src="src/ui/retro-fx.js"></script>
    
    <!-- Audio -->
    <script src="src/audio/sfx.js"></script>
    
    <!-- Input -->
    <script src="src/input/input-handler.js"></script>
    <script src="src/input/touch-controls.js"></script>
    
    <!-- Entities -->
    <script src="src/entities/sprite.js"></script>
    <script src="src/entities/ship.js"></script>
    <script src="src/entities/bullet.js"></script>
    <script src="src/entities/alien.js"></script>
    <script src="src/entities/asteroid.js"></script>
    <script src="src/entities/explosion.js"></script>
    <script src="src/entities/data-fragment.js"></script>
    <script src="src/entities/silo.js"></script>
    <script src="src/entities/similarity-pickup.js"></script>
    
    <!-- Game -->
    <script src="src/game/game.js"></script>
    <script src="src/game/dase-mode.js"></script>
    <script src="src/game/similarity-mode.js"></script>
    <script src="src/game/game-fsm.js"></script>
    <script src="src/game/intro.js"></script>
    
    <!-- Main Entry Point -->
    <script src="src/main.js"></script>
    
    <style>
      body { 
        background: #0E142C; 
        color: #E5E7EB; 
        font-family: 'Courier New', monospace;
        margin: 0;
        padding: 20px;
        overflow-x: hidden;
      }
      
      #game-container { 
        background: #0E142C;
        position: relative;
        display: inline-block;
        max-width: 100%;
      }
      
      #canvas { 
        border: 1px solid #1FD9FE; 
        display: block;
        max-width: 100%;
        height: auto;
      }
      
      /* Mobile-specific body styles */
      @media screen and (max-width: 800px) {
        body {
          padding: 0;
          margin: 0;
          display: flex;
          flex-direction: column;
          min-height: 100vh;
          min-height: 100dvh;
        }
        
        #game-container {
          width: 100%;
          flex-grow: 1;
          display: flex;
          justify-content: center;
          align-items: flex-start;
        }
        
        #canvas {
          width: 100%;
          max-height: calc(100vh - 180px);
          max-height: calc(100dvh - 180px);
          object-fit: contain;
        }
      }
      
      .button { 
        position: absolute; 
        border: 1px solid #1FD9FE; 
        color: #E5E7EB; 
        background: transparent;
        font-family: 'Courier New', monospace;
      }
      
      #left-controls { 
        position: absolute; 
        left: 1px; 
        bottom: 0px; 
        display: none; 
      }
      
      #right-controls { 
        position: absolute; 
        right: 1px; 
        bottom: 0px; 
        display: none; 
      }
      
      #up { width: 200px; height: 100px; bottom: 100px; }
      #left { width: 100px; height: 100px; bottom: 0px; }
      #right { width: 100px; height: 100px; bottom: 0px; left: 100px; }
      #space { width: 200px; height: 200px; bottom: 0px; right: 0px; }
      
      .controls-info {
        margin-top: 20px;
        font-size: 12px;
        color: #9CA3AF;
      }
      
      .controls-info kbd {
        background: #1a2744;
        padding: 2px 6px;
        border-radius: 3px;
        border: 1px solid #1FD9FE;
      }
    </style>
  </head>
  <body>
    <div id="game-container">
      <canvas id="canvas" width="780" height="540"></canvas>
      <div id="left-controls">
        <div id="up" class="button">THRUST</div>
        <div id="left" class="button">LEFT</div>
        <div id="right" class="button">RIGHT</div>
      </div>
      <div id="right-controls">
        <div id="space" class="button">FIRE</div>
      </div>
    </div>
    
    <div style="margin-top:12px; color:#E5E7EB; font-family: 'Courier New', monospace;">
      Letters per asteroid: 
      <input id="char-slider" type="range" min="40" max="400" step="10" value="200" style="width:240px; vertical-align:middle;">
      <span id="char-value" style="display:inline-block; width:40px; text-align:right;">200</span>
      <button id="toggle-retro-tv" aria-pressed="false" style="margin-left:10px; padding:6px 10px; background:#0f162f; color:#E5E7EB; border:1px solid #1FD9FE; border-radius:6px; cursor:pointer;">Retro TV: OFF</button>
    </div>
    
    <div style="margin-top:8px; color:#E5E7EB; font-family: 'Courier New', monospace;">
      Aumento dificultad por wave: 
      <input id="difficulty-slider" type="range" min="0" max="30" step="5" value="10" style="width:180px; vertical-align:middle;">
      <span id="difficulty-value" style="display:inline-block; width:40px; text-align:right;">10%</span>
    </div>
    
    <div class="controls-info">
      <p>
        <kbd>←</kbd> <kbd>→</kbd> Rotate | 
        <kbd>↑</kbd> Thrust | 
        <kbd>SPACE</kbd> Fire | 
        <kbd>P</kbd> Pause | 
        <kbd>M</kbd> Mute |
        <kbd>F</kbd> FPS
      </p>
      <button id="test-next-level" style="margin-top:6px; padding:6px 10px; background:#0f162f; color:#E5E7EB; border:1px solid #1FD9FE; border-radius:6px; cursor:pointer;">Test NEXT LEVEL</button>
      <button id="toggle-fps" aria-pressed="false" style="margin-left:10px; padding:6px 10px; background:#0f162f; color:#7cf0ff; border:1px solid #1FD9FE; border-radius:6px; cursor:pointer;">FPS: OFF</button>
      <span id="fps-readout" style="margin-left:10px; padding:6px 10px; color:#7cf0ff; border:1px solid rgba(31,217,254,0.35); border-radius:6px; display:none;">FPS: --</span>
    </div>

    <script>
      (function() {
        var btn = document.getElementById('test-next-level');
        if (btn) {
          btn.addEventListener('click', function() {
            if (window.LevelTransitionManager && window.Game && Game.ship) {
              LevelTransitionManager.start(Game.ship);
            }
          });
        }
      })();
    </script>
  </body>
</html>
